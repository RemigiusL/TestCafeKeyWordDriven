"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const endpoint_utils_1 = require("endpoint-utils");
const config_1 = __importDefault(require("./config"));
const create_temp_profile_1 = __importDefault(require("./create-temp-profile"));
const is_docker_1 = __importDefault(require("is-docker"));
async function default_1(proxyHostName, configString) {
    const config = config_1.default(configString);
    const tempProfileDir = !config.userProfile ? await create_temp_profile_1.default(proxyHostName, config) : null;
    const cdpPort = config.cdpPort || (!config.userProfile ? await endpoint_utils_1.getFreePort() : null);
    const inDocker = is_docker_1.default();
    return {
        config,
        cdpPort,
        tempProfileDir,
        inDocker
    };
}
exports.default = default_1;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVudGltZS1pbmZvLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2Jyb3dzZXIvcHJvdmlkZXIvYnVpbHQtaW4vZGVkaWNhdGVkL2Nocm9tZS9ydW50aW1lLWluZm8uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxtREFBNkM7QUFDN0Msc0RBQWlDO0FBQ2pDLGdGQUFzRDtBQUN0RCwwREFBaUM7QUFFbEIsS0FBSyxvQkFBVyxhQUFhLEVBQUUsWUFBWTtJQUN0RCxNQUFNLE1BQU0sR0FBVyxnQkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQy9DLE1BQU0sY0FBYyxHQUFHLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSw2QkFBaUIsQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNuRyxNQUFNLE9BQU8sR0FBVSxNQUFNLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxNQUFNLDRCQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUYsTUFBTSxRQUFRLEdBQVMsbUJBQVEsRUFBRSxDQUFDO0lBRWxDLE9BQU87UUFDSCxNQUFNO1FBQ04sT0FBTztRQUNQLGNBQWM7UUFDZCxRQUFRO0tBQ1gsQ0FBQztBQUNOLENBQUM7QUFaRCw0QkFZQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEZyZWVQb3J0IH0gZnJvbSAnZW5kcG9pbnQtdXRpbHMnO1xuaW1wb3J0IGdldENvbmZpZyBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgY3JlYXRlVGVtcFByb2ZpbGUgZnJvbSAnLi9jcmVhdGUtdGVtcC1wcm9maWxlJztcbmltcG9ydCBpc0RvY2tlciBmcm9tICdpcy1kb2NrZXInO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiAocHJveHlIb3N0TmFtZSwgY29uZmlnU3RyaW5nKSB7XG4gICAgY29uc3QgY29uZmlnICAgICAgICAgPSBnZXRDb25maWcoY29uZmlnU3RyaW5nKTtcbiAgICBjb25zdCB0ZW1wUHJvZmlsZURpciA9ICFjb25maWcudXNlclByb2ZpbGUgPyBhd2FpdCBjcmVhdGVUZW1wUHJvZmlsZShwcm94eUhvc3ROYW1lLCBjb25maWcpIDogbnVsbDtcbiAgICBjb25zdCBjZHBQb3J0ICAgICAgICA9IGNvbmZpZy5jZHBQb3J0IHx8ICghY29uZmlnLnVzZXJQcm9maWxlID8gYXdhaXQgZ2V0RnJlZVBvcnQoKSA6IG51bGwpO1xuICAgIGNvbnN0IGluRG9ja2VyICAgICAgID0gaXNEb2NrZXIoKTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgY2RwUG9ydCxcbiAgICAgICAgdGVtcFByb2ZpbGVEaXIsXG4gICAgICAgIGluRG9ja2VyXG4gICAgfTtcbn1cbiJdfQ==